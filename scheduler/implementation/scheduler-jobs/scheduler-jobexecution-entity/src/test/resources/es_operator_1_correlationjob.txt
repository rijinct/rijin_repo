insert overwrite table es_operator_1 SELECT c.OPERATOR_ID,c.OPERATOR_NAME,c.COUNTRY_ID, c.COUNTRY_NAME,c.ROAMING,c.ROAMING_TYPE FROM 
  (SELECT DISTINCT CAST(c1.OPERATOR_ID AS INT) AS OPERATOR_ID,SUBSTR(c1.OPERATOR_NAME,1,decode((nvl(length(c1.OPERATOR_NAME),0)>=500),false,length(c1.OPERATOR_NAME),500)) AS OPERATOR_NAME, c2.COUNTRY_ID, c2.COUNTRY_NAME,
  CASE
  THEN 'N'
  ELSE 'I'
  END AS ROAMING_TYPE
  FROM
  (SELECT DISTINCT RO.OPERATOR_ID, RO.OPERATOR_NAME FROM 
  (SELECT t.OPERATOR_ID,  t.OPERATOR_NAME,  RANK(t.OPERATOR_ID, t.OPERATOR_NAME ) as rnk
  FROM ( select OPERATOR_ID,  OPERATOR_NAME 
  from  EXT_GSM_DCS_NETWORK_OPER_1
  DISTRIBUTE BY OPERATOR_ID
  SORT BY OPERATOR_ID,  OPERATOR_NAME ) t) RO
  WHERE RO.RNK=1
  ) c1 join
  (SELECT country_id,country_name FROM EXT_MOBILE_COUNTRY_CODES_1) c2
  WHERE SUBSTR(c1.OPERATOR_ID,1,3) = TRIM(c2.COUNTRY_ID)) C FULL OUTER JOIN ES_OPERATOR_1 D
  ON (CAST(c.operator_ID AS INT) = d.operator_ID and c.operator_name=d.operator_name and c.country_id=d.country_id
  )