select distinct on (job_name) job_name,start_time,(case when status='S' then 'Pass' else 'Fail' end) as status from sairepo.etl_status where (job_name like '%%Usage%%LoadJob%%' or job_name like '%%Entity%%CorrelationJob%%')  and (status='S' or status='E') and start_time >= TIMESTAMP 'yesterday' and start_time < TIMESTAMP 'today' order by job_name,(case status when 'S' then 1 when 'E' then 2 end), start_time desc;